import requests

def check_vulnerabilities(name: str, version: str, purl: str = None) -> list:
    payload = {"package": {"purl": purl}} if purl else {"package": {"name": name}, "version": version}
    try:
        resp = requests.post("https://api.osv.dev/v1/query", json=payload)
        resp.raise_for_status()
        vulns = resp.json().get("vulns", [])
        return [
            {
                "id": v.get("id"),
                "summary": v.get("summary"),
                "details": v.get("details"),
                "references": v.get("references", [])
            }
            for v in vulns
        ]
    except Exception as e:
        print(f"OSV query failed: {e}")
        return []